<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Tests</title>
    <script src="../hxl.js"></script>
    <script src="../hxlBites.js"></script>
    <script src="../hxlBitesChart.js"></script>
    <script src="../hxlBitesTimeSeries.js"></script>
    <script src="../hxlBitesCrossTables.js"></script>
    <script src="../hxlBitesMap.js"></script>
    <script src="../hxlBitesRender.js"></script>
    <script src="../hxlBitesTable.js"></script>
    <script src="../hxlBitesText.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"></script>
  </head>
  <body>
    <p>Open console to see tests</p>
  </body>
  <script>
    console.log('Running Tests');
  	$.ajax({
  		url: "https://beta.proxy.hxlstandard.org/data/1d0a79/download/africa-dtm-baseline-assessments-topline.json",
  		success: function(result){
        let output = hxlBites.data(result).getMapBites();
        console.log(output);
        if(output.length>8){
          console.error('Map Test Fail: Too many results');
        } else if (output[0].uniqueID != 'map0002/#country+code/2/#population+hh+idps/5') {
          console.error('Map Test Fail: Unexpected ID');
          console.log(output[0].uniqueID);
        } else {
          console.log('Map Test Pass');
        }

        let bite = hxlBites.data(result).reverse('map0002/#country+code/2/#population+hh+idps/5');
        console.log(bite);
        bite = hxlBites.data(result).reverse('chart0009/#country+name/1/#population+hh+idps/5');
        console.log(bite);
        bite = hxlBites.data(result).reverse('map0002/#adm1+code/4/#population+idps+ind/6');
        console.log(bite);

      },
      error: function(err){
        console.log(err);
      }
    });
    $.ajax({
      url: "https://beta.proxy.hxlstandard.org/data/1d0a79/download/africa-dtm-baseline-assessments-topline.json",
      success: function(result){
        let output = hxlBites.data(result).getTextBites();
        console.log(output);
        output = hxlBites.data(result).reverse('text0012/#population+idps+ind/6');
        console.log(output);
        console.log("Text bites success");

      },
      error: function(err){
        console.log(err);
      }
    });
    $.ajax({
      url: 'https://proxy.hxlstandard.org/data.json?filter01=cut&cut-include-tags01=%23modality%2C+%23channel&url=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2F1s-piTxQUT0Q8ReO6uVy-72ZFb3R9K3I5zAnb2YNN83c%2Fedit%23gid%3D1496776846',
      success: function(result){
        let output = hxlBites.data(result).getChartBites();
        console.log(output);
        if(output.length==3){
          console.log("Modality chart bite success");
        } else {
          console.warn("Modality chart bite fail");
        }
      },
      error: function(err){
        console.log(err);
      }
    });
    $.ajax({
      url: 'https://proxy.hxlstandard.org/data.json?url=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2Fe%2F2PACX-1vSrr9DRaC2fXzPdmOxLW-egSYtxmEp_RKoYGggt-zOKYXSx4RjPsM4EO19H7OJVX1esTtIoFvlKFWcn%2Fpub%3Fgid%3D1564028913%26single%3Dtrue%26output%3Dcsv',
      success: function(result){
        let output = hxlBites.data(result).getTextBites();
        console.log(output);
      },
      error: function(err){
        console.log(err);
      }
    });
    $.ajax({
      url: 'https://proxy.hxlstandard.org/data.json?url=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2Fe%2F2PACX-1vSrr9DRaC2fXzPdmOxLW-egSYtxmEp_RKoYGggt-zOKYXSx4RjPsM4EO19H7OJVX1esTtIoFvlKFWcn%2Fpub%3Fgid%3D1564028913%26single%3Dtrue%26output%3Dcsv',
      success: function(result){
        let output = hxlBites.data(result).getTextBites();
        console.log(output);
      },
      error: function(err){
        console.log(err);
      }
    });
    $.ajax({
      url: "https://beta.proxy.hxlstandard.org/data/1d0a79/download/africa-dtm-baseline-assessments-topline.json",
      success: function(result){
        let output = hxlBites.data(result).getMapBites();
        console.log(output);
        if(output.length>8){
          console.error('Map Test Fail: Too many results');
        } else if (output[0].uniqueID != 'map0002/#country+code/2/#population+hh+idps/5') {
          console.error('Map Test Fail: Unexpected ID');
          console.log(output[0].uniqueID);
        } else {
          console.log('Map Test Pass');
        }

        let bite = hxlBites.data(result).reverse('map0002/#country+code/2/#population+hh+idps/5');
        console.log(bite);
        bite = hxlBites.data(result).reverse('chart0009/#country+name/1/#population+hh+idps/5');
        console.log(bite);
        bite = hxlBites.data(result).reverse('map0002/#adm1+code/4/#population+idps+ind/6');
        console.log(bite);

      },
      error: function(err){
        console.log(err);
      }
    });
    $.ajax({
      url: "https://proxy.hxlstandard.org/data.json?url=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2Fe%2F2PACX-1vSrr9DRaC2fXzPdmOxLW-egSYtxmEp_RKoYGggt-zOKYXSx4RjPsM4EO19H7OJVX1esTtIoFvlKFWcn%2Fpub%3Fgid%3D1564028913%26single%3Dtrue%26output%3Dcsv",
      success: function(result){
        //console.log(hxlBites.data(result).getTimeSeriesBites());
        console.log(hxlBites.data(result).reverse('time0002/#date+event/0/#affected+infected+total/7'));
        console.log(hxlBites.data(result).reverse('chart0021/#adm2+health+name/4/#affected+confirmed+infected/6'));
      },
      error: function(err){
        console.log(err);
      }
    });
    $.ajax({
      url: "https://proxy.hxlstandard.org/data.json?url=https%3A%2F%2Fbeta.proxy.hxlstandard.org%2Fdata%2F1d0a79%2Fdownload%2Fafrica-dtm-baseline-assessments-topline.csv",
      success: function(result){
        console.log(hxlBites.data(result).getTextBites());
      },
      error: function(err){
        console.log(err);
      }
    });
    $.ajax({
      url: "https://proxy.hxlstandard.org/data.json?filter01=replace-map&replace-map-url01=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2F1hTE0U3V8x18homc5KxfA7IIrv1Y9F1oulhJt0Z4z3zo%2Fedit%23gid%3D0&filter02=merge&merge-url02=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2F1GugpfyzridvfezFcDsl6dNlpZDqI8TQJw-Jx52obny8%2Fedit%23gid%3D0&merge-keys02=%23country%2Bname&merge-tags02=%23country%2Bcode&url=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2F1eo0HCLg-kcRe3716DZbgSOA3dWBopJNcECeswFSFCYs%2Fedit%23gid%3D0",
      success: function(result){
        //console.log(hxlBites.data(result).getTimeSeriesBites());
        console.log(result)
        console.log(hxlBites.data(result).reverse('map0001/#country+code/10'));
      },
      error: function(err){
        console.log(err);
      }
    });
    $.ajax({
      url: "https://proxy.hxlstandard.org/data.json?force=1&url=https%3A%2F%2Fdocs.google.com%2Fspreadsheets%2Fd%2F1lH4KPEGMpEAaYtEAMU-UddBXcqX5usMQzT8u-BMJ2PY%2Fedit%23gid%3D0",
      success: function(result){
        console.log(result)
        console.log(hxlBites.data(result).reverse('cross0001/#loc/0/#status/7'));
      },
      error: function(err){
        console.log(err);
      }
    });
  </script>
</html>